import{c as t,l as e,w as a,k as i,O as s,e as o,Q as n,ag as l,a3 as r,t as d,ao as h}from"./index.BRpw1nKc.js";import{v as p}from"./el-loading.BV6rMv2f.js";import{E as c}from"./el-scrollbar.CSr5ETPp.js";import{E as m}from"./el-date-picker.CSS3cjq0.js";import"./el-popper.D4W13mvh.js";import{a as g,E as _}from"./el-select.5v61zF81.js";import{E as u}from"./el-row.q_U4h3Z4.js";import{E as y}from"./el-col.CaebfPGa.js";import{E as f}from"./el-card.BBukHcQ3.js";import{E as x}from"./el-statistic.RYFpL2bl.js";import{s as k}from"./screen-height.COx2xJHy.js";import{s as w}from"./member.H5_1ajQq.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{u as v,i as D,a as C,b,c as M}from"./installCanvasRenderer.BU9Xfj2q.js";import{i as E,a as $}from"./install.Be7BgDCX.js";import{i as Y,a as T}from"./install.6My4tGJu.js";import{i as V}from"./install.8F3SWQ07.js";import"./debounce.CixRjyEa.js";import"./index.HiC8GQQr.js";import"./isUndefined.DgmxjSXK.js";import"./_Uint8Array.CFsNisPO.js";import"./castArray.CIpvmybx.js";import"./tagsView.BGKYC20W.js";v([E,Y,D,V,T,C,$,b]);const O={class:"app-container"},A={class:"text-center"},S=["title"],U=["id"];const I=j({name:"MemberStatistic",data:()=>({name:"会员统计",height:680,loading:!1,count:[],echart_id:"echartid",echart_num:1,echart_data:[],date_type:"day",date_range:[],date_options:{},date_ptype:"monthrange",date_format:"YYYY-MM",picker_options_day:{shortcuts:[{text:"最近7天",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-5184e5),t.$emit("pick",[a,e])}},{text:"最近30天",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-25056e5),t.$emit("pick",[a,e])}},{text:"最近90天",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-76896e5),t.$emit("pick",[a,e])}},{text:"最近120天",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-102816e5),t.$emit("pick",[a,e])}}]},picker_options_month:{shortcuts:[{text:"最近3个月",onClick(t){const e=new Date,a=new Date;a.setMonth(a.getMonth()-2),t.$emit("pick",[a,e])}},{text:"最近6个月",onClick(t){const e=new Date,a=new Date;a.setMonth(a.getMonth()-5),t.$emit("pick",[a,e])}},{text:"最近9个月",onClick(t){const e=new Date,a=new Date;a.setMonth(a.getMonth()-8),t.$emit("pick",[a,e])}},{text:"最近12个月",onClick(t){const e=new Date,a=new Date;a.setMonth(a.getMonth()-11),t.$emit("pick",[a,e])}}]}}),watch:{echart_data(){this.$nextTick((()=>{this.setEchart()}))}},created(){this.height=k(140),this.statistic()},methods:{statistic(){this.loading=!0,w({type:this.date_type,date:this.date_range}).then((t=>{this.count=t.data.count,this.echart_data=t.data.echart,this.echart_num=t.data.echart.length,this.dateOptions(),this.loading=!1})).catch((()=>{this.loading=!1}))},typeChange(){this.dateOptions(),this.date_range=[]},dateOptions(){const t=this.date_type;"day"===t?(this.date_ptype="daterange",this.date_format="YYYY-MM-DD",this.date_options=this.picker_options_day):"month"===t&&(this.date_ptype="monthrange",this.date_format="YYYY-MM",this.date_options=this.picker_options_month)},dateChange(){this.statistic()},setEchart(){const t=this.echart_data,e=this.echart_num,a=this.echart_id;for(let i=0;i<e;i++)this.initEchart(t[i],a+i),this.date_type=t[i].type,this.date_range=t[i].date},initEchart(t,e){var a=M(document.getElementById(e)),i={title:{text:t.title,textStyle:{fontSize:12}},legend:{top:"20px",data:t.legend,selected:{"总数":!1}},grid:{top:"80px",left:"1%",right:"3%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:t.xAxis},yAxis:{type:"value"},tooltip:{trigger:"axis",textStyle:{align:"left"}},toolbox:{feature:{magicType:{show:!0,type:["line","bar"]},dataView:{show:!0,readOnly:!0},saveAsImage:{show:!0,name:this.name+t.date[0]+"-"+t.date[1]}}},series:t.series};a.setOption(i)}}},[["render",function(k,w,j,v,D,C){const b=x,M=f,E=y,$=u,Y=g,T=_,V=m,I=c,Q=p;return t(),e(I,{native:"",height:D.height},{default:a((()=>[i("div",O,[s((t(),e($,{gutter:10},{default:a((()=>[(t(!0),o(n,null,l(D.count,((s,o)=>(t(),e(E,{key:o,xs:24,span:3},{default:a((()=>[r(M,{"body-style":{padding:"10px 0px"}},{header:a((()=>[i("div",A,[i("span",null,d(s.name),1)])])),default:a((()=>[i("div",{class:"text-center",title:s.title},[r(b,{value:s.count},null,8,["value"])],8,S)])),_:2},1024)])),_:2},1024)))),128))])),_:1})),[[Q,D.loading]]),(t(!0),o(n,null,l(D.echart_num,((o,n)=>s((t(),e(M,{key:n,class:"mt-[10px]"},{default:a((()=>[r($,{class:"text-center"},{default:a((()=>[r(E,null,{default:a((()=>[r(T,{modelValue:D.date_type,"onUpdate:modelValue":w[0]||(w[0]=t=>D.date_type=t),class:"!w-[100px]",onChange:C.typeChange},{default:a((()=>[r(Y,{label:k.$t("common.day"),value:"day"},null,8,["label"]),r(Y,{label:k.$t("common.month"),value:"month"},null,8,["label"])])),_:1},8,["modelValue","onChange"]),r(V,{modelValue:D.date_range,"onUpdate:modelValue":w[1]||(w[1]=t=>D.date_range=t),type:D.date_ptype,"value-format":D.date_format,"picker-options":D.date_options,"start-placeholder":k.$t("common.Start date"),"end-placeholder":k.$t("common.End date"),onChange:C.dateChange},null,8,["modelValue","type","value-format","picker-options","start-placeholder","end-placeholder","onChange"])])),_:1}),r(E,null,{default:a((()=>[i("div",{id:D.echart_id+n,style:h({height:D.height-300+"px"})},null,12,U)])),_:2},1024)])),_:2},1024)])),_:2},1024)),[[Q,D.loading]]))),128))])])),_:1},8,["height"])}]]);export{I as default};
