import{h as e,R as t,T as n,U as i,V as o,_ as r,j as a,k as l,W as s,X as c,Y as d,$ as g,a0 as p,a1 as u,a2 as h,a3 as f,a4 as y,m,e as v,a5 as x,a6 as S,o as I,a7 as _,Z as w,z as C,a8 as G,a9 as b,aa as R,ab as P,ac as D,ad as M,ae as O,J as A,af as k,ag as L,ah as B,ai as W,aj as z,I as T,ak as N,r as V,v as F,u as H}from"./installCanvasRenderer.BU9Xfj2q.js";function E(i,o,r){var a=o.getBoxLayoutParams(),l=o.get("padding"),s={width:r.getWidth(),height:r.getHeight()},c=e(a,s,l);t(o.get("orient"),i,o.get("itemGap"),c.width,c.height),n(i,a,s,l)}function K(e,t){var n=i(t.get("padding")),r=t.getItemStyle(["color","opacity"]);return r.fill=t.get("backgroundColor"),e=new o({shape:{x:e.x-n[3],y:e.y-n[0],width:e.width+n[1]+n[3],height:e.height+n[0]+n[2],r:t.get("borderRadius")},style:r,silent:!0,z2:-1})}var j=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n.layoutMode={type:"box",ignoreSize:!0},n}return r(t,e),t.prototype.init=function(e,t,n){this.mergeDefaultAndTheme(e,n),e.selected=e.selected||{},this._updateSelector(e)},t.prototype.mergeOption=function(t,n){e.prototype.mergeOption.call(this,t,n),this._updateSelector(t)},t.prototype._updateSelector=function(e){var t=e.selector,n=this.ecModel;!0===t&&(t=e.selector=["all","inverse"]),a(t)&&l(t,(function(e,i){y(e)&&(e={type:e}),t[i]=s(e,function(e,t){return"all"===t?{type:"all",title:e.getLocaleModel().get(["legend","selector","all"])}:"inverse"===t?{type:"inverse",title:e.getLocaleModel().get(["legend","selector","inverse"])}:void 0}(n,e.type))}))},t.prototype.optionUpdated=function(){this._updateData(this.ecModel);var e=this._data;if(e[0]&&"single"===this.get("selectedMode")){for(var t=!1,n=0;n<e.length;n++){var i=e[n].get("name");if(this.isSelected(i)){this.select(i),t=!0;break}}!t&&this.select(e[0].get("name"))}},t.prototype._updateData=function(e){var t=[],n=[];e.eachRawSeries((function(i){var o,r=i.name;if(n.push(r),i.legendVisualProvider){var a=i.legendVisualProvider.getAllNames();e.isSeriesFiltered(i)||(n=n.concat(a)),a.length?t=t.concat(a):o=!0}else o=!0;o&&c(i)&&t.push(i.name)})),this._availableNames=n;var i=this.get("data")||t,o=d(),r=g(i,(function(e){return(y(e)||m(e))&&(e={name:e}),o.get(e.name)?null:(o.set(e.name,!0),new p(e,this,this.ecModel))}),this);this._data=u(r,(function(e){return!!e}))},t.prototype.getData=function(){return this._data},t.prototype.select=function(e){var t=this.option.selected;if("single"===this.get("selectedMode")){var n=this._data;l(n,(function(e){t[e.get("name")]=!1}))}t[e]=!0},t.prototype.unSelect=function(e){"single"!==this.get("selectedMode")&&(this.option.selected[e]=!1)},t.prototype.toggleSelected=function(e){var t=this.option.selected;t.hasOwnProperty(e)||(t[e]=!0),this[t[e]?"unSelect":"select"](e)},t.prototype.allSelect=function(){var e=this._data,t=this.option.selected;l(e,(function(e){t[e.get("name",!0)]=!0}))},t.prototype.inverseSelect=function(){var e=this._data,t=this.option.selected;l(e,(function(e){var n=e.get("name",!0);t.hasOwnProperty(n)||(t[n]=!0),t[n]=!t[n]}))},t.prototype.isSelected=function(e){var t=this.option.selected;return!(t.hasOwnProperty(e)&&!t[e])&&h(this._availableNames,e)>=0},t.prototype.getOrient=function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},t.type="legend.plain",t.dependencies=["series"],t.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},t}(f),U=A,J=l,Y=k,Z=function(n){function i(){var e=null!==n&&n.apply(this,arguments)||this;return e.type=i.type,e.newlineDisabled=!1,e}return r(i,n),i.prototype.init=function(){this.group.add(this._contentGroup=new Y),this.group.add(this._selectorGroup=new Y),this._isFirstRender=!0},i.prototype.getContentGroup=function(){return this._contentGroup},i.prototype.getSelectorGroup=function(){return this._selectorGroup},i.prototype.render=function(t,n,i){var o=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),t.get("show",!0)){var r=t.get("align"),a=t.get("orient");r&&"auto"!==r||(r="right"===t.get("left")&&"vertical"===a?"right":"left");var l=t.get("selector",!0),s=t.get("selectorPosition",!0);!l||s&&"auto"!==s||(s="horizontal"===a?"end":"start"),this.renderInner(r,t,n,i,l,a,s);var c=t.getBoxLayoutParams(),d={width:i.getWidth(),height:i.getHeight()},g=t.get("padding"),p=e(c,d,g),u=this.layoutInner(t,r,p,o,l,s),h=e(v({width:u.width,height:u.height},c),d,g);this.group.x=h.x-u.x,this.group.y=h.y-u.y,this.group.markRedraw(),this.group.add(this._backgroundEl=K(u,t))}},i.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},i.prototype.renderInner=function(e,t,n,i,o,r,a){var l=this.getContentGroup(),s=d(),c=t.get("selectedMode"),g=[];n.eachRawSeries((function(e){!e.get("legendHoverLink")&&g.push(e.id)})),J(t.getData(),(function(o,r){var a=o.get("name");if(!this.newlineDisabled&&(""===a||"\n"===a)){var d=new Y;return d.newline=!0,void l.add(d)}var p=n.getSeriesByName(a)[0];if(!s.get(a))if(p){var u=p.getData(),h=u.getVisual("legendLineStyle")||{},f=u.getVisual("legendIcon"),y=u.getVisual("style"),m=this._createItem(p,a,r,o,t,e,h,y,f,c,i);m.on("click",U(q,a,null,i,g)).on("mouseover",U($,p.name,null,i,g)).on("mouseout",U(Q,p.name,null,i,g)),n.ssr&&m.eachChild((function(e){var t=x(e);t.seriesIndex=p.seriesIndex,t.dataIndex=r,t.ssrType="legend"})),s.set(a,!0)}else n.eachRawSeries((function(l){if(!s.get(a)&&l.legendVisualProvider){var d=l.legendVisualProvider;if(!d.containName(a))return;var p=d.indexOfName(a),u=d.getItemVisual(p,"style"),h=d.getItemVisual(p,"legendIcon"),f=S(u.fill);f&&0===f[3]&&(f[3]=.2,u=I(I({},u),{fill:_(f,"rgba")}));var y=this._createItem(l,a,r,o,t,e,{},u,h,c,i);y.on("click",U(q,null,a,i,g)).on("mouseover",U($,null,a,i,g)).on("mouseout",U(Q,null,a,i,g)),n.ssr&&y.eachChild((function(e){var t=x(e);t.seriesIndex=l.seriesIndex,t.dataIndex=r,t.ssrType="legend"})),s.set(a,!0)}}),this)}),this),o&&this._createSelector(o,t,i,r,a)},i.prototype._createSelector=function(e,t,n,i,o){var r=this.getSelectorGroup();J(e,(function(e){var i=e.type,o=new w({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){n.dispatchAction({type:"all"===i?"legendAllSelect":"legendInverseSelect"})}});r.add(o);var a=t.getModel("selectorLabel"),l=t.getModel(["emphasis","selectorLabel"]);C(o,{normal:a,emphasis:l},{defaultText:e.title}),G(o)}))},i.prototype._createItem=function(e,t,n,i,r,a,l,s,c,d,g){var p=e.visualDrawType,u=r.get("itemWidth"),h=r.get("itemHeight"),f=r.isSelected(t),m=i.get("symbolRotate"),v=i.get("symbolKeepAspect"),x=i.get("icon"),S=function(e,t,n,i,o,r,a){function l(e,t){"auto"===e.lineWidth&&(e.lineWidth=t.lineWidth>0?2:0),J(e,(function(n,i){"inherit"===e[i]&&(e[i]=t[i])}))}var s=t.getModel("itemStyle"),c=s.getItemStyle(),d=0===e.lastIndexOf("empty",0)?"fill":"stroke",g=s.getShallow("decal");c.decal=g&&"inherit"!==g?M(g,a):i.decal,"inherit"===c.fill&&(c.fill=i[o]);"inherit"===c.stroke&&(c.stroke=i[d]);"inherit"===c.opacity&&(c.opacity=("fill"===o?i:n).opacity);l(c,i);var p=t.getModel("lineStyle"),u=p.getLineStyle();if(l(u,n),"auto"===c.fill&&(c.fill=i.fill),"auto"===c.stroke&&(c.stroke=i.fill),"auto"===u.stroke&&(u.stroke=i.fill),!r){var h=t.get("inactiveBorderWidth"),f=c[d];c.lineWidth="auto"===h?i.lineWidth>0&&f?2:0:c.lineWidth,c.fill=t.get("inactiveColor"),c.stroke=t.get("inactiveBorderColor"),u.stroke=p.get("inactiveColor"),u.lineWidth=p.get("inactiveWidth")}return{itemStyle:c,lineStyle:u}}(c=x||c||"roundRect",i,l,s,p,f,g),I=new Y,_=i.getModel("textStyle");if(!b(e.getLegendIcon)||x&&"inherit"!==x){var C="inherit"===x&&e.getData().getVisual("symbol")?"inherit"===m?e.getData().getVisual("symbolRotate"):m:0;I.add(function(e){var t=e.icon||"roundRect",n=O(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill,e.symbolKeepAspect);n.setStyle(e.itemStyle),n.rotation=(e.iconRotate||0)*Math.PI/180,n.setOrigin([e.itemWidth/2,e.itemHeight/2]),t.indexOf("empty")>-1&&(n.style.stroke=n.style.fill,n.style.fill="#fff",n.style.lineWidth=2);return n}({itemWidth:u,itemHeight:h,icon:c,iconRotate:C,itemStyle:S.itemStyle,lineStyle:S.lineStyle,symbolKeepAspect:v}))}else I.add(e.getLegendIcon({itemWidth:u,itemHeight:h,icon:c,iconRotate:m,itemStyle:S.itemStyle,lineStyle:S.lineStyle,symbolKeepAspect:v}));var D="left"===a?u+5:-5,A=a,k=r.get("formatter"),L=t;y(k)&&k?L=k.replace("{name}",null!=t?t:""):b(k)&&(L=k(t));var B=f?_.getTextColor():i.get("inactiveColor");I.add(new w({style:R(_,{text:L,x:D,y:h/2,fill:B,align:A,verticalAlign:"middle"},{inheritColor:B})}));var W=new o({shape:I.getBoundingRect(),style:{fill:"transparent"}}),z=i.getModel("tooltip");return z.get("show")&&P({el:W,componentModel:r,itemName:t,itemTooltipOption:z.option}),I.add(W),I.eachChild((function(e){e.silent=!0})),W.silent=!d,this.getContentGroup().add(I),G(I),I.__legendDataIndex=n,I},i.prototype.layoutInner=function(e,n,i,o,r,a){var l=this.getContentGroup(),s=this.getSelectorGroup();t(e.get("orient"),l,e.get("itemGap"),i.width,i.height);var c=l.getBoundingRect(),d=[-c.x,-c.y];if(s.markRedraw(),l.markRedraw(),r){t("horizontal",s,e.get("selectorItemGap",!0));var g=s.getBoundingRect(),p=[-g.x,-g.y],u=e.get("selectorButtonGap",!0),h=e.getOrient().index,f=0===h?"width":"height",y=0===h?"height":"width",m=0===h?"y":"x";"end"===a?p[h]+=c[f]+u:d[h]+=g[f]+u,p[1-h]+=c[y]/2-g[y]/2,s.x=p[0],s.y=p[1],l.x=d[0],l.y=d[1];var v={x:0,y:0};return v[f]=c[f]+u+g[f],v[y]=Math.max(c[y],g[y]),v[m]=Math.min(0,g[m]+p[1-h]),v}return l.x=d[0],l.y=d[1],this.group.getBoundingRect()},i.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},i.type="legend.plain",i}(D);function q(e,t,n,i){Q(e,t,n,i),n.dispatchAction({type:"legendToggleSelect",name:null!=e?e:t}),$(e,t,n,i)}function X(e){for(var t,n=e.getZr().storage.getDisplayList(),i=0,o=n.length;i<o&&!(t=n[i].states.emphasis);)i++;return t&&t.hoverLayer}function $(e,t,n,i){X(n)||n.dispatchAction({type:"highlight",seriesName:e,name:t,excludeSeriesId:i})}function Q(e,t,n,i){X(n)||n.dispatchAction({type:"downplay",seriesName:e,name:t,excludeSeriesId:i})}function ee(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries((function(e){for(var n=0;n<t.length;n++)if(!t[n].isSelected(e.name))return!1;return!0}))}function te(e,t,n){var i,o={},r="toggleSelected"===e;return n.eachComponent("legend",(function(n){r&&null!=i?n[i?"select":"unSelect"](t.name):"allSelect"===e||"inverseSelect"===e?n[e]():(n[e](t.name),i=n.isSelected(t.name));var a=n.getData();l(a,(function(e){var t=e.get("name");if("\n"!==t&&""!==t){var i=n.isSelected(t);o.hasOwnProperty(t)?o[t]=o[t]&&i:o[t]=i}}))})),"allSelect"===e||"inverseSelect"===e?{selected:o}:{name:t.name,selected:o}}function ne(e){e.registerComponentModel(j),e.registerComponentView(Z),e.registerProcessor(e.PRIORITY.PROCESSOR.SERIES_FILTER,ee),e.registerSubTypeDefaulter("legend",(function(){return"plain"})),function(e){e.registerAction("legendToggleSelect","legendselectchanged",A(te,"toggleSelected")),e.registerAction("legendAllSelect","legendselectall",A(te,"allSelect")),e.registerAction("legendInverseSelect","legendinverseselect",A(te,"inverseSelect")),e.registerAction("legendSelect","legendselected",A(te,"select")),e.registerAction("legendUnSelect","legendunselected",A(te,"unSelect"))}(e)}var ie=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.type=t.type,n}return r(t,e),t.prototype.setScrollDataIndex=function(e){this.option.scrollDataIndex=e},t.prototype.init=function(t,n,i){var o=L(t);e.prototype.init.call(this,t,n,i),oe(this,t,o)},t.prototype.mergeOption=function(t,n){e.prototype.mergeOption.call(this,t,n),oe(this,this.option,t)},t.type="legend.scroll",t.defaultOption=B(j.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),t}(j);function oe(e,t,n){var i=[1,1];i[e.getOrient().index]=0,W(t,n,{type:"box",ignoreSize:!!i})}var re=k,ae=["width","height"],le=["x","y"],se=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=n.type,t.newlineDisabled=!0,t._currentIndex=0,t}return r(n,e),n.prototype.init=function(){e.prototype.init.call(this),this.group.add(this._containerGroup=new re),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new re)},n.prototype.resetInner=function(){e.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},n.prototype.renderInner=function(t,n,i,o,r,l,s){var c=this;e.prototype.renderInner.call(this,t,n,i,o,r,l,s);var d=this._controllerGroup,g=n.get("pageIconSize",!0),p=a(g)?g:[g,g];h("pagePrev",0);var u=n.getModel("pageTextStyle");function h(e,t){var i=e+"DataIndex",r=z(n.get("pageIcons",!0)[n.getOrient().name][t],{onclick:T(c._pageGo,c,i,n,o)},{x:-p[0]/2,y:-p[1]/2,width:p[0],height:p[1]});r.name=e,d.add(r)}d.add(new w({name:"pageText",style:{text:"xx/xx",fill:u.getTextColor(),font:u.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),h("pageNext",1)},n.prototype.layoutInner=function(e,n,i,o,r,a){var l=this.getSelectorGroup(),s=e.getOrient().index,c=ae[s],d=le[s],g=ae[1-s],p=le[1-s];r&&t("horizontal",l,e.get("selectorItemGap",!0));var u=e.get("selectorButtonGap",!0),h=l.getBoundingRect(),f=[-h.x,-h.y],y=N(i);r&&(y[c]=i[c]-h[c]-u);var m=this._layoutContentAndController(e,o,y,s,c,g,p,d);if(r){if("end"===a)f[s]+=m[c]+u;else{var v=h[c]+u;f[s]-=v,m[d]-=v}m[c]+=h[c]+u,f[1-s]+=m[p]+m[g]/2-h[g]/2,m[g]=Math.max(m[g],h[g]),m[p]=Math.min(m[p],h[p]+f[1-s]),l.x=f[0],l.y=f[1],l.markRedraw()}return m},n.prototype._layoutContentAndController=function(e,n,i,r,a,l,s,c){var d=this.getContentGroup(),g=this._containerGroup,p=this._controllerGroup;t(e.get("orient"),d,e.get("itemGap"),r?i.width:null,r?null:i.height),t("horizontal",p,e.get("pageButtonItemGap",!0));var u=d.getBoundingRect(),h=p.getBoundingRect(),f=this._showController=u[a]>i[a],y=[-u.x,-u.y];n||(y[r]=d[c]);var m=[0,0],v=[-h.x,-h.y],x=V(e.get("pageButtonGap",!0),e.get("itemGap",!0));f&&("end"===e.get("pageButtonPosition",!0)?v[r]+=i[a]-h[a]:m[r]+=h[a]+x);v[1-r]+=u[l]/2-h[l]/2,d.setPosition(y),g.setPosition(m),p.setPosition(v);var S={x:0,y:0};if(S[a]=f?i[a]:u[a],S[l]=Math.max(u[l],h[l]),S[s]=Math.min(0,h[s]+v[1-r]),g.__rectSize=i[a],f){var I={x:0,y:0};I[a]=Math.max(i[a]-h[a]-x,0),I[l]=S[l],g.setClipPath(new o({shape:I})),g.__rectSize=I[a]}else p.eachChild((function(e){e.attr({invisible:!0,silent:!0})}));var _=this._getPageInfo(e);return null!=_.pageIndex&&F(d,{x:_.contentPosition[0],y:_.contentPosition[1]},f?e:null),this._updatePageInfoView(e,_),S},n.prototype._pageGo=function(e,t,n){var i=this._getPageInfo(t)[e];null!=i&&n.dispatchAction({type:"legendScroll",scrollDataIndex:i,legendId:t.id})},n.prototype._updatePageInfoView=function(e,t){var n=this._controllerGroup;l(["pagePrev","pageNext"],(function(i){var o=null!=t[i+"DataIndex"],r=n.childOfName(i);r&&(r.setStyle("fill",o?e.get("pageIconColor",!0):e.get("pageIconInactiveColor",!0)),r.cursor=o?"pointer":"default")}));var i=n.childOfName("pageText"),o=e.get("pageFormatter"),r=t.pageIndex,a=null!=r?r+1:0,s=t.pageCount;i&&o&&i.setStyle("text",y(o)?o.replace("{current}",null==a?"":a+"").replace("{total}",null==s?"":s+""):o({current:a,total:s}))},n.prototype._getPageInfo=function(e){var t=e.get("scrollDataIndex",!0),n=this.getContentGroup(),i=this._containerGroup.__rectSize,o=e.getOrient().index,r=ae[o],a=le[o],l=this._findTargetItemIndex(t),s=n.children(),c=s[l],d=s.length,g=d?1:0,p={contentPosition:[n.x,n.y],pageCount:g,pageIndex:g-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!c)return p;var u=v(c);p.contentPosition[o]=-u.s;for(var h=l+1,f=u,y=u,m=null;h<=d;++h)(!(m=v(s[h]))&&y.e>f.s+i||m&&!x(m,f.s))&&(f=y.i>f.i?y:m)&&(null==p.pageNextDataIndex&&(p.pageNextDataIndex=f.i),++p.pageCount),y=m;for(h=l-1,f=u,y=u,m=null;h>=-1;--h)(m=v(s[h]))&&x(y,m.s)||!(f.i<y.i)||(y=f,null==p.pagePrevDataIndex&&(p.pagePrevDataIndex=f.i),++p.pageCount,++p.pageIndex),f=m;return p;function v(e){if(e){var t=e.getBoundingRect(),n=t[a]+e[a];return{s:n,e:n+t[r],i:e.__legendDataIndex}}}function x(e,t){return e.e>=t&&e.s<=t+i}},n.prototype._findTargetItemIndex=function(e){return this._showController?(this.getContentGroup().eachChild((function(i,o){var r=i.__legendDataIndex;null==n&&null!=r&&(n=o),r===e&&(t=o)})),null!=t?t:n):0;var t,n},n.type="legend.scroll",n}(Z);function ce(e){H(ne),e.registerComponentModel(ie),e.registerComponentView(se),function(e){e.registerAction("legendScroll","legendscroll",(function(e,t){var n=e.scrollDataIndex;null!=n&&t.eachComponent({mainType:"legend",subType:"scroll",query:e},(function(e){e.setScrollDataIndex(n)}))}))}(e)}function de(e){H(ne),H(ce)}export{de as i,E as l,K as m};
