import{as as e,ac as l,ad as a,c as t,e as s,a3 as o,w as i,Q as d,ag as r,l as u,a2 as m,k as n,t as p,ab as c,O as h,P as f,az as _,at as b}from"./index.BRpw1nKc.js";import{v as y}from"./el-loading.BV6rMv2f.js";import{E as g}from"./el-scrollbar.CSr5ETPp.js";import{_ as V}from"./FileUploads.CmqZ9qQ6.js";import{_ as v}from"./index.B8TJitXy.js";import{E as k,a as w}from"./el-table-column.CutgeWLk.js";import"./el-checkbox.EDgu4e6h.js";import"./el-tooltip.l0sNRNKZ.js";import"./el-popper.D4W13mvh.js";import{E as j}from"./el-link.DPD7VmMd.js";import{a as q,E as U}from"./el-select.5v61zF81.js";import{E as x}from"./el-dialog._ZabjypL.js";import{a as C,E as D}from"./el-form-item.BMwGbftj.js";import{E as T}from"./el-switch.DGE1lg0h.js";import{E as I}from"./el-row.q_U4h3Z4.js";import{E}from"./el-col.CaebfPGa.js";import{_ as S}from"./index.CwjPZbsy.js";import{E as A}from"./el-date-picker.CSS3cjq0.js";import{s as $}from"./screen-height.COx2xJHy.js";import{a as F}from"./index.Cp1HnnF1.js";import{g as G}from"./settings.HJzUBU6Z.js";import{_ as O}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./el-image-viewer.BB7HyzD-.js";import"./debounce.CixRjyEa.js";import"./el-text.D8Jxf6kI.js";import"./index.B5yjKjmX.js";import"./FilePreview.DjJYlL3Z.js";import"./clipboard.DxwZ1MhR.js";/* empty css                          */import"./el-card.BBukHcQ3.js";/* empty css                       */import"./permission.BG2swUZV.js";import"./group.D6uVsq_i.js";import"./tag.DI6CRSc4.js";import"./index.Dg10_69g.js";import"./_Uint8Array.CFsNisPO.js";import"./index.HiC8GQQr.js";import"./isUndefined.DgmxjSXK.js";import"./castArray.CIpvmybx.js";import"./refs.BDPfTQKo.js";import"./tagsView.BGKYC20W.js";const z="/admin/setting.Feedback/";const P={class:"app-container"},Y={class:"c-red"};const H=O({name:"SettingFeedback",components:{Pagination:v},data:()=>({name:"反馈",height:680,loading:!1,idkey:"feedback_id",exps:[{exp:"like",name:"包含"}],query:{page:1,limit:G(),search_field:"title",search_exp:"like",date_field:"create_time"},data:[],count:0,dialog:!1,dialogTitle:"",model:{feedback_id:"",member_id:0,member_username:"",receipt_no:"",type:0,title:"",content:"",images:[],phone:"",email:"",reply:"",remark:"",status:0},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},types:[],statuss:[],selection:[],selectIds:"",selectTitle:"操作",selectDialog:!1,selectType:"",status:0,is_disable:0}),created(){this.height=$(),this.list()},methods:{list(){var l;this.loading=!0,(l=this.query,e({url:z+"list",method:"get",params:l})).then((e=>{this.data=e.data.list,this.count=e.data.count,this.types=e.data.types,this.statuss=e.data.statuss,this.exps=e.data.exps,this.loading=!1})).catch((()=>{this.loading=!1}))},add(){this.dialog=!0,this.dialogTitle=this.name+"添加",this.reset()},edit(l){this.dialog=!0,this.dialogTitle=this.name+"修改："+l[this.idkey];var a,t={};t[this.idkey]=l[this.idkey],(a=t,e({url:z+"info",method:"get",params:a})).then((e=>{this.reset(e.data)})).catch((()=>{}))},cancel(){this.dialog=!1,this.reset()},submit(){this.$refs.ref.validate((a=>{var t;a&&(this.loading=!0,this.model[this.idkey]?(t=this.model,e({url:z+"edit",method:"post",data:t})).then((e=>{this.list(),this.dialog=!1,l.success(e.msg)})).catch((()=>{this.loading=!1})):function(l){return e({url:z+"add",method:"post",data:l})}(this.model).then((e=>{this.list(),this.dialog=!1,l.success(e.msg)})).catch((()=>{this.loading=!1})))}))},reset(e){if(this.model=e||this.$options.data().model,void 0!==this.$refs.ref)try{this.$refs.ref.resetFields(),this.$refs.ref.clearValidate()}catch(l){}},search(){this.query.page=1,this.list()},refresh(){const e=this.query.limit;this.query=this.$options.data().query,this.$refs.table.clearSort(),this.query.limit=e,this.list()},sort(e){this.query.sort_field=e.prop,this.query.sort_value="","ascending"===e.order&&(this.query.sort_value="asc",this.list()),"descending"===e.order&&(this.query.sort_value="desc",this.list())},select(e){this.selection=e,this.selectIds=this.selectGetIds(e).toString()},selectGetIds(e){return F(e,this.idkey)},selectAlert(){a.alert("请选择需要操作的"+this.name,"提示",{type:"warning",callback:()=>{}})},selectOpen(e,l=""){if(l){this.$refs.table.clearSelection();const e=l.length;for(let a=0;a<e;a++)this.$refs.table.toggleRowSelection(l[a],!0)}this.selection.length?(this.selectTitle="操作","status"===e?this.selectTitle=this.name+"状态":"disable"===e?this.selectTitle=this.name+"是否禁用":"dele"===e&&(this.selectTitle=this.name+"删除"),this.selectDialog=!0,this.selectType=e):this.selectAlert()},selectCancel(){this.selectDialog=!1},selectSubmit(){if(this.selection.length){const e=this.selectType;"status"===e?this.editsta(this.selection,!0):"disable"===e?this.disable(this.selection,!0):"dele"===e&&this.dele(this.selection),this.selectDialog=!1}else this.selectAlert()},editsta(a,t){if(a.length){this.loading=!0;var s=a[0].status;t&&(s=this.status),(o={ids:this.selectGetIds(a),status:s},e({url:z+"status",method:"post",data:o})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.list()}))}else this.selectAlert();var o},disable(a,t=!1){if(a.length){this.loading=!0;var s=a[0].is_disable;t&&(s=this.is_disable),(o={ids:this.selectGetIds(a),is_disable:s},e({url:z+"disable",method:"post",data:o})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.list()}))}else this.selectAlert();var o},dele(a){var t;a.length?(this.loading=!0,(t={ids:this.selectGetIds(a)},e({url:z+"dele",method:"post",data:t})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.loading=!1}))):this.selectAlert()}}},[["render",function(e,l,a,$,F,G){const O=q,z=U,H=_,M=A,B=b,J=S,K=E,L=I,Q=C,R=T,N=D,W=x,X=k,Z=j,ee=w,le=v,ae=V,te=g,se=y;return t(),s("div",P,[o(L,null,{default:i((()=>[o(K,{class:"mb-2"},{default:i((()=>[o(z,{modelValue:F.query.search_field,"onUpdate:modelValue":l[0]||(l[0]=e=>F.query.search_field=e),class:"ya-search-field",placeholder:"查询字段"},{default:i((()=>[o(O,{value:F.idkey,label:"ID"},null,8,["value"]),o(O,{value:"type",label:"类型"}),o(O,{value:"status",label:"状态"}),o(O,{value:"title",label:"标题"}),o(O,{value:"phone",label:"手机"}),o(O,{value:"email",label:"邮箱"}),o(O,{value:"receipt_no",label:"回执"}),o(O,{value:"remark",label:"备注"}),o(O,{value:"is_disable",label:"禁用"})])),_:1},8,["modelValue"]),o(z,{modelValue:F.query.search_exp,"onUpdate:modelValue":l[1]||(l[1]=e=>F.query.search_exp=e),class:"ya-search-exp"},{default:i((()=>[(t(!0),s(d,null,r(F.exps,(e=>(t(),u(O,{key:e.exp,value:e.exp,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),"status"===F.query.search_field?(t(),u(z,{key:0,modelValue:F.query.search_value,"onUpdate:modelValue":l[2]||(l[2]=e=>F.query.search_value=e),class:"ya-search-value"},{default:i((()=>[(t(!0),s(d,null,r(F.statuss,((e,l)=>(t(),u(O,{key:l,label:e,value:l},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):"is_disable"===F.query.search_field?(t(),u(z,{key:1,modelValue:F.query.search_value,"onUpdate:modelValue":l[3]||(l[3]=e=>F.query.search_value=e),class:"ya-search-value"},{default:i((()=>[o(O,{value:1,label:"是"}),o(O,{value:0,label:"否"})])),_:1},8,["modelValue"])):"type"===F.query.search_field?(t(),u(z,{key:2,modelValue:F.query.search_value,"onUpdate:modelValue":l[4]||(l[4]=e=>F.query.search_value=e),class:"ya-search-value"},{default:i((()=>[(t(!0),s(d,null,r(F.types,((e,l)=>(t(),u(O,{key:l,label:e,value:l},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])):(t(),u(H,{key:3,modelValue:F.query.search_value,"onUpdate:modelValue":l[5]||(l[5]=e=>F.query.search_value=e),class:"ya-search-value",placeholder:"查询内容",clearable:""},null,8,["modelValue"])),o(z,{modelValue:F.query.date_field,"onUpdate:modelValue":l[6]||(l[6]=e=>F.query.date_field=e),class:"ya-date-field",placeholder:"时间类型"},{default:i((()=>[o(O,{value:"create_time",label:"添加时间"}),o(O,{value:"update_time",label:"修改时间"})])),_:1},8,["modelValue"]),o(M,{modelValue:F.query.date_value,"onUpdate:modelValue":l[7]||(l[7]=e=>F.query.date_value=e),type:"datetimerange",class:"ya-date-value","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD HH:mm:ss","default-time":[new Date(2024,1,1,0,0,0),new Date(2024,1,1,23,59,59)]},null,8,["modelValue","default-time"]),o(B,{type:"primary",onClick:l[8]||(l[8]=e=>G.search())},{default:i((()=>[m("查询")])),_:1}),o(B,{title:"重置",onClick:l[9]||(l[9]=e=>G.refresh())},{default:i((()=>[o(J,{"icon-class":"refresh"})])),_:1}),o(B,{type:"primary",onClick:l[10]||(l[10]=e=>G.add())},{default:i((()=>[m("添加")])),_:1})])),_:1})])),_:1}),o(L,null,{default:i((()=>[o(K,null,{default:i((()=>[o(B,{title:"删除",onClick:l[11]||(l[11]=e=>G.selectOpen("dele"))},{default:i((()=>[m("删除")])),_:1}),o(B,{title:"禁用",onClick:l[12]||(l[12]=e=>G.selectOpen("disable"))},{default:i((()=>[m("禁用")])),_:1}),o(B,{title:"状态",onClick:l[13]||(l[13]=e=>G.selectOpen("status"))},{default:i((()=>[m("状态")])),_:1})])),_:1})])),_:1}),o(W,{modelValue:F.selectDialog,"onUpdate:modelValue":l[17]||(l[17]=e=>F.selectDialog=e),title:F.selectTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"20vh"},{footer:i((()=>[o(B,{loading:F.loading,onClick:G.selectCancel},{default:i((()=>[m("取消")])),_:1},8,["loading","onClick"]),o(B,{loading:F.loading,type:"primary",onClick:G.selectSubmit},{default:i((()=>[m("提交")])),_:1},8,["loading","onClick"])])),default:i((()=>[o(N,{"label-width":"120px"},{default:i((()=>["status"===F.selectType?(t(),u(Q,{key:0,label:"状态"},{default:i((()=>[o(z,{modelValue:F.status,"onUpdate:modelValue":l[14]||(l[14]=e=>F.status=e),class:"ya-search-value"},{default:i((()=>[(t(!0),s(d,null,r(F.statuss,((e,l)=>(t(),u(O,{key:l,label:e,value:l},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):"disable"===F.selectType?(t(),u(Q,{key:1,label:"是否禁用"},{default:i((()=>[o(R,{modelValue:F.is_disable,"onUpdate:modelValue":l[15]||(l[15]=e=>F.is_disable=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})):"dele"===F.selectType?(t(),u(Q,{key:2},{default:i((()=>[n("span",Y,"确定要删除选中的"+p(F.name)+"吗？",1)])),_:1})):c("",!0),o(Q,{label:F.name+"ID"},{default:i((()=>[o(H,{modelValue:F.selectIds,"onUpdate:modelValue":l[16]||(l[16]=e=>F.selectIds=e),type:"textarea",autosize:"",disabled:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1},8,["modelValue","title"]),h((t(),u(ee,{ref:"table",data:F.data,height:F.height,onSortChange:G.sort,onSelectionChange:G.select},{default:i((()=>[o(X,{type:"selection",width:"42",title:"全选/反选"}),o(X,{prop:F.idkey,label:"ID",width:"80",sortable:"custom"},null,8,["prop"]),o(X,{prop:"member_username",label:"会员","min-width":"80","show-overflow-tooltip":""}),o(X,{prop:"type_name",label:"类型","min-width":"80","show-overflow-tooltip":""}),o(X,{prop:"title",label:"标题","min-width":"200","show-overflow-tooltip":""}),o(X,{prop:"phone",label:"手机","min-width":"120","show-overflow-tooltip":""}),o(X,{prop:"email",label:"邮箱","min-width":"130","show-overflow-tooltip":""}),o(X,{prop:"remark",label:"备注","min-width":"100","show-overflow-tooltip":""}),o(X,{prop:"status",label:"状态","min-width":"85",sortable:"custom"},{default:i((e=>[m(p(F.statuss[e.row.status]),1)])),_:1}),o(X,{prop:"is_disable",label:"禁用","min-width":"85",sortable:"custom"},{default:i((e=>[o(R,{modelValue:e.row.is_disable,"onUpdate:modelValue":l=>e.row.is_disable=l,"active-value":1,"inactive-value":0,onChange:l=>G.disable([e.row])},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),o(X,{prop:"receipt_no",label:"回执编号","min-width":"100","show-overflow-tooltip":""}),o(X,{prop:"create_time",label:"添加时间",width:"165",sortable:"custom"}),o(X,{prop:"update_time",label:"修改时间",width:"165",sortable:"custom"}),o(X,{label:"操作",width:"95"},{default:i((e=>[o(Z,{type:"primary",class:"mr-1",underline:!1,onClick:l=>G.edit(e.row)},{default:i((()=>[m(" 修改 ")])),_:2},1032,["onClick"]),o(Z,{type:"primary",underline:!1,onClick:l=>G.selectOpen("dele",[e.row])},{default:i((()=>[m(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","height","onSortChange","onSelectionChange"])),[[se,F.loading]]),h(o(le,{total:F.count,"onUpdate:total":l[18]||(l[18]=e=>F.count=e),page:F.query.page,"onUpdate:page":l[19]||(l[19]=e=>F.query.page=e),limit:F.query.limit,"onUpdate:limit":l[20]||(l[20]=e=>F.query.limit=e),onPagination:G.list},null,8,["total","page","limit","onPagination"]),[[f,F.count>0]]),o(W,{modelValue:F.dialog,"onUpdate:modelValue":l[36]||(l[36]=e=>F.dialog=e),title:F.dialogTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":G.cancel,top:"5vh"},{footer:i((()=>[o(B,{loading:F.loading,onClick:G.cancel},{default:i((()=>[m("取消")])),_:1},8,["loading","onClick"]),o(B,{loading:F.loading,type:"primary",onClick:G.submit},{default:i((()=>[m("提交")])),_:1},8,["loading","onClick"])])),default:i((()=>[o(te,{native:"",height:F.height-30},{default:i((()=>[o(N,{ref:"ref",rules:F.rules,model:F.model,"label-width":"100px"},{default:i((()=>[o(Q,{label:"会员ID",prop:"member_id"},{default:i((()=>[o(K,{span:8},{default:i((()=>[o(H,{modelValue:F.model.member_id,"onUpdate:modelValue":l[21]||(l[21]=e=>F.model.member_id=e),placeholder:"请输入会员ID",clearable:""},null,8,["modelValue"])])),_:1}),o(K,{class:"text-center",span:4},{default:i((()=>[m("会员用户名")])),_:1}),o(K,{span:12},{default:i((()=>[o(H,{modelValue:F.model.member_username,"onUpdate:modelValue":l[22]||(l[22]=e=>F.model.member_username=e),placeholder:"",disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),o(Q,{label:"类型",prop:"type"},{default:i((()=>[o(z,{modelValue:F.model.type,"onUpdate:modelValue":l[23]||(l[23]=e=>F.model.type=e)},{default:i((()=>[(t(!0),s(d,null,r(F.types,((e,l)=>(t(),u(O,{key:l,label:e,value:l},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(Q,{label:"标题",prop:"title"},{default:i((()=>[o(H,{modelValue:F.model.title,"onUpdate:modelValue":l[24]||(l[24]=e=>F.model.title=e),placeholder:"请输入标题",clearable:""},null,8,["modelValue"])])),_:1}),o(Q,{label:"内容",prop:"content"},{default:i((()=>[o(H,{modelValue:F.model.content,"onUpdate:modelValue":l[25]||(l[25]=e=>F.model.content=e),type:"textarea",autosize:"",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1}),o(Q,{label:"图片",prop:"images"},{default:i((()=>[o(ae,{modelValue:F.model.images,"onUpdate:modelValue":l[26]||(l[26]=e=>F.model.images=e),"upload-btn":"上传图片","file-type":"image","file-tip":"图片文件"},null,8,["modelValue"])])),_:1}),o(Q,{label:"手机",prop:"phone"},{default:i((()=>[o(H,{modelValue:F.model.phone,"onUpdate:modelValue":l[27]||(l[27]=e=>F.model.phone=e),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1}),o(Q,{label:"邮箱",prop:"email"},{default:i((()=>[o(H,{modelValue:F.model.email,"onUpdate:modelValue":l[28]||(l[28]=e=>F.model.email=e),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1}),o(Q,{label:"回复",prop:"reply"},{default:i((()=>[o(H,{modelValue:F.model.reply,"onUpdate:modelValue":l[29]||(l[29]=e=>F.model.reply=e),type:"textarea",autosize:"",placeholder:"请输入回复"},null,8,["modelValue"])])),_:1}),o(Q,{label:"状态",prop:"status"},{default:i((()=>[o(z,{modelValue:F.model.status,"onUpdate:modelValue":l[30]||(l[30]=e=>F.model.status=e)},{default:i((()=>[(t(!0),s(d,null,r(F.statuss,((e,l)=>(t(),u(O,{key:l,label:e,value:l},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(Q,{label:"备注",prop:"remark"},{default:i((()=>[o(H,{modelValue:F.model.remark,"onUpdate:modelValue":l[31]||(l[31]=e=>F.model.remark=e),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1}),o(Q,{label:"回执",prop:"receipt_no"},{default:i((()=>[o(H,{modelValue:F.model.receipt_no,"onUpdate:modelValue":l[32]||(l[32]=e=>F.model.receipt_no=e),placeholder:"回执编号（唯一）",clearable:""},null,8,["modelValue"])])),_:1}),F.model[F.idkey]?(t(),u(Q,{key:0,label:"添加时间",prop:"create_time"},{default:i((()=>[o(H,{modelValue:F.model.create_time,"onUpdate:modelValue":l[33]||(l[33]=e=>F.model.create_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),F.model[F.idkey]?(t(),u(Q,{key:1,label:"修改时间",prop:"update_time"},{default:i((()=>[o(H,{modelValue:F.model.update_time,"onUpdate:modelValue":l[34]||(l[34]=e=>F.model.update_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),F.model.delete_time?(t(),u(Q,{key:2,label:"删除时间",prop:"delete_time"},{default:i((()=>[o(H,{modelValue:F.model.delete_time,"onUpdate:modelValue":l[35]||(l[35]=e=>F.model.delete_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0)])),_:1},8,["rules","model"])])),_:1},8,["height"])])),_:1},8,["modelValue","title","before-close"])])}]]);export{H as default};
