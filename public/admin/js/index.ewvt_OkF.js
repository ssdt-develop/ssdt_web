import{b as e,h as t,aS as o,aW as a,cI as l,d as n,a as r,aX as i,de as u,df as s,r as d,D as f,aF as c,K as p,o as v,G as m,bI as g,aB as h,V as y,c as w,e as b,k as _,f as x,n as C,g as $,ao as O,_ as E,s as j,ct as S,dg as V,dh as A,di as F,dj as P,dk as I,a6 as N,dl as B,dm as D,L as T,a3 as k,w as H,bY as U}from"./index.BRpw1nKc.js";import{E as z}from"./el-dialog._ZabjypL.js";import{F as L}from"./index.B5yjKjmX.js";const M=e({zIndex:{type:t([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),J={scroll:({scrollTop:e,fixed:t})=>o(e)&&a(t),[l]:e=>a(e)},K="ElAffix",W=n({name:K});const Y=j(E(n({...W,props:M,emits:J,setup(e,{expose:t,emit:o}){const a=e,l=r("affix"),n=i(),E=i(),j=i(),{height:S}=u(),{height:V,width:A,top:F,bottom:P,update:I}=s(E,{windowScroll:!1}),N=s(n),B=d(!1),D=d(0),T=d(0),k=f((()=>({height:B.value?`${V.value}px`:"",width:B.value?`${A.value}px`:""}))),H=f((()=>{if(!B.value)return{};const e=a.offset?c(a.offset):0;return{height:`${V.value}px`,width:`${A.value}px`,top:"top"===a.position?e:"",bottom:"bottom"===a.position?e:"",transform:T.value?`translateY(${T.value}px)`:"",zIndex:a.zIndex}})),U=()=>{if(j.value)if(D.value=j.value instanceof Window?document.documentElement.scrollTop:j.value.scrollTop||0,"top"===a.position)if(a.target){const e=N.bottom.value-a.offset-V.value;B.value=a.offset>F.value&&N.bottom.value>0,T.value=e<0?e:0}else B.value=a.offset>F.value;else if(a.target){const e=S.value-N.top.value-a.offset-V.value;B.value=S.value-a.offset<P.value&&S.value>N.top.value,T.value=e<0?-e:0}else B.value=S.value-a.offset<P.value};return p(B,(e=>o("change",e))),v((()=>{var e;a.target?(n.value=null!=(e=document.querySelector(a.target))?e:void 0,n.value||m(K,`Target does not exist: ${a.target}`)):n.value=document.documentElement,j.value=g(E.value,!0),I()})),h(j,"scroll",(()=>{I(),o("scroll",{scrollTop:D.value,fixed:B.value})})),y(U),t({update:U,updateRoot:I}),(e,t)=>(w(),b("div",{ref_key:"root",ref:E,class:C($(l).b()),style:O($(k))},[_("div",{class:C({[$(l).m("fixed")]:B.value}),style:O($(H))},[x(e.$slots,"default")],6)],6))}}),[["__file","affix.vue"]]));var q=Object.defineProperty,G=Object.defineProperties,R=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,ee=(e,t,o)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,te=(e,t)=>{for(var o in t||(t={}))Q.call(t,o)&&ee(e,o,t[o]);if(X)for(var o of X(t))Z.call(t,o)&&ee(e,o,t[o]);return e};function oe(e){let t=`请使用 '@${e}' 事件，不要放在 props 中`;return t+=`\nPlease use '@${e}' event instead of props`,t}var ae=(e,t)=>{for(const[o,a]of t)e[o]=a;return e};const le=n({props:{mode:{type:String,default:"default"},defaultContent:{type:Array,default:[]},defaultHtml:{type:String,default:""},defaultConfig:{type:Object,default:{}},modelValue:{type:String,default:""}},setup(e,t){const o=d(null),a=i(null),l=d("");return v((()=>{(()=>{if(!o.value)return;const n=S(e.defaultContent);var r,i;V({selector:o.value,mode:e.mode,content:n||[],html:e.defaultHtml||e.modelValue||"",config:(r=te({},e.defaultConfig),i={onCreated(o){if(a.value=o,t.emit("onCreated",o),e.defaultConfig.onCreated){const e=oe("onCreated");throw new Error(e)}},onChange(o){const a=o.getHtml();if(l.value=a,t.emit("update:modelValue",a),t.emit("onChange",o),e.defaultConfig.onChange){const e=oe("onChange");throw new Error(e)}},onDestroyed(o){if(t.emit("onDestroyed",o),e.defaultConfig.onDestroyed){const e=oe("onDestroyed");throw new Error(e)}},onMaxLength(o){if(t.emit("onMaxLength",o),e.defaultConfig.onMaxLength){const e=oe("onMaxLength");throw new Error(e)}},onFocus(o){if(t.emit("onFocus",o),e.defaultConfig.onFocus){const e=oe("onFocus");throw new Error(e)}},onBlur(o){if(t.emit("onBlur",o),e.defaultConfig.onBlur){const e=oe("onBlur");throw new Error(e)}},customAlert(o,a){if(t.emit("customAlert",o,a),e.defaultConfig.customAlert){const e=oe("customAlert");throw new Error(e)}},customPaste:(o,a)=>{if(e.defaultConfig.customPaste){const e=oe("customPaste");throw new Error(e)}let l;return t.emit("customPaste",o,a,(e=>{l=e})),l}},G(r,R(i)))})})()})),p((()=>e.modelValue),(e=>{e!==l.value&&function(e){const t=a.value;if(null==t)return;const o=t.isDisabled(),l=t.isFocused(),n=JSON.stringify(t.selection);if(t.enable(),t.focus(),t.select([]),t.deleteFragment(),A.setNodes(t,{type:"paragraph"},{mode:"highest"}),t.dangerouslyInsertHtml(e),!l)return t.deselect(),void t.blur();if(o)return t.deselect(),void t.disable();try{t.select(JSON.parse(n))}catch(r){t.select(F.start(t,[]))}}(e)})),{box:o}}}),ne={ref:"box",style:{height:"100%"}};var re=ae(le,[["render",function(e,t,o,a,l,n){return w(),b("div",ne,null,512)}]]);const ie=n({props:{editor:{type:Object},mode:{type:String,default:"default"},defaultConfig:{type:Object,default:{}}},setup(e){const t=d(null);return y((()=>{const{editor:o}=e;null!=o&&(o=>{if(t.value){if(null==o)throw new Error("Not found instance of Editor when create <Toolbar/> component");P.getToolbar(o)||I({editor:o,selector:t.value||"<div></div>",mode:e.mode,config:e.defaultConfig})}})(o)})),{selector:t}}}),ue={ref:"selector"};var se=ae(ie,[["render",function(e,t,o,a,l,n){return w(),b("div",ue,null,512)}]]);const de={class:"editor-wrapper"},fe={__name:"index",props:{modelValue:{type:[String],default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,a=N(),l=t;B("zh-cn"==a.language?"zh-CN":"en");const n=D(o,"modelValue",l),r=i(),u=d("default"),s=d({insertKeys:{index:24,keys:["uploadAttachment"]}}),f=d({placeholder:"请输入内容...",MENU_CONF:{uploadImage:{customBrowseAndUpload(){v.value=!0,g.value="image"}},uploadVideo:{customBrowseAndUpload(){v.value=!0,g.value="video"}},uploadAttachment:{customBrowseAndUpload(){v.value=!0,g.value="word"}}}}),c=e=>{r.value=e};function p(e){n.value=e.getHtml()}const v=d(!1),m=d("文件管理"),g=d("image");function h(){v.value=!1}function y(e){v.value=!1;var t="";const o=e.length;for(let a=0;a<o;a++)"image"===e[a].file_type?t+=`<img file-id="${e[a].file_id}" src="${e[a].file_url}" style="width:640px;"/>`:"video"===e[a].file_type?t+=`<div data-w-e-type="video" data-w-e-is-void><video width="640" height="480" controls>\n                <source file-id="${e[a].file_id}" src="${e[a].file_url}" type="video/mp4">\n                <object file-id="${e[a].file_id}" data="${e[a].file_url}">\n                  <embed file-id="${e[a].file_id}" src="${e[a].file_url}" width="640" height="480">\n                </object>\n              </video></div>`:"audio"===e[a].file_type?t+=`<div data-w-e-type="audio" data-w-e-is-void data-w-e-is-inline><audio controls>\n                <source file-id="${e[a].file_id}" src="${e[a].file_url}" type="audio/mp3">\n                <embed file-id="${e[a].file_id}" src="${e[a].file_url}">\n              </audio></div>`:t+=`<div data-w-e-type="attachment" data-w-e-is-void data-w-e-is-inline><a file-id="${e[a].file_id}" href="${e[a].file_url}" download="${e[a].file_url}" target="_blank">${e[a].file_name}.${e[a].file_ext}</a></div>`;r.value.dangerouslyInsertHtml(t)}return T((()=>{const e=r.value;null!=e&&e.destroy()})),(e,t)=>{const o=Y,a=z;return w(),b("div",de,[k(o,{target:".editor-wrapper",offset:150},{default:H((()=>[k($(se),{id:"toolbar-container",editor:$(r),"default-config":$(s),mode:$(u)},null,8,["editor","default-config","mode"])])),_:1}),k($(re),{id:"editor-container",modelValue:$(n),"onUpdate:modelValue":t[0]||(t[0]=e=>U(n)?n.value=e:null),"default-config":$(f),mode:$(u),onOnChange:p,onOnCreated:c},null,8,["modelValue","default-config","mode"]),k(a,{modelValue:$(v),"onUpdate:modelValue":t[1]||(t[1]=e=>U(v)?v.value=e:null),title:$(m),"close-on-click-modal":!1,"close-on-press-escape":!1,top:"1vh",width:"80%","append-to-body":""},{default:H((()=>[k(L,{"file-type":$(g),onFileCancel:h,onFileSubmit:y},null,8,["file-type"])])),_:1},8,["modelValue","title"])])}}};export{fe as _};
