import{dr as e,ds as l,ad as t,dt as a,ac as o,c as s,e as i,k as d,a3 as r,w as u,a2 as n,Q as m,ag as p,l as c,t as h,ab as _,O as f,P as g,at as y,az as V}from"./index.BRpw1nKc.js";import{v as b}from"./el-loading.BV6rMv2f.js";import{E as q}from"./el-scrollbar.CSr5ETPp.js";import{_ as k}from"./index.B8TJitXy.js";import{E as v,a as w}from"./el-table-column.CutgeWLk.js";import"./el-checkbox.EDgu4e6h.js";import"./el-tooltip.l0sNRNKZ.js";import"./el-popper.D4W13mvh.js";import{E as j}from"./el-link.DPD7VmMd.js";import{a as U,E as x}from"./el-select.5v61zF81.js";import{E as C}from"./el-dialog._ZabjypL.js";import{a as I,E as D}from"./el-form-item.BMwGbftj.js";import{E as P}from"./el-row.q_U4h3Z4.js";import{E as S}from"./el-col.CaebfPGa.js";import{_ as T}from"./index.CwjPZbsy.js";import{E}from"./el-date-picker.CSS3cjq0.js";import{s as A}from"./screen-height.COx2xJHy.js";import{h as $}from"./clipboard.DxwZ1MhR.js";import{a as O}from"./index.Cp1HnnF1.js";import{g as R}from"./settings.HJzUBU6Z.js";import{_ as Y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./_Uint8Array.CFsNisPO.js";import"./debounce.CixRjyEa.js";import"./index.HiC8GQQr.js";import"./isUndefined.DgmxjSXK.js";import"./castArray.CIpvmybx.js";import"./refs.BDPfTQKo.js";import"./tagsView.BGKYC20W.js";const z={class:"filter-container"},G={class:"c-red"};const H=Y({name:"SystemUserCenterLog",components:{Pagination:k},data:()=>({name:"我的日志",height:680,loading:!0,idkey:"log_id",exps:[{exp:"like",name:"包含"}],query:{page:1,limit:R(),search_field:"request_region",search_exp:"like",date_field:"create_time"},data:[],count:0,dialog:!1,dialogTitle:"",model:{},rules:{},logTypes:[],selection:[],selectIds:"",selectTitle:"操作",selectDialog:!1,selectType:""}),created(){this.height=A(310),this.list()},methods:{list(){this.loading=!0,e(this.query).then((e=>{this.data=e.data.list,this.count=e.data.count,this.logTypes=e.data.log_types,this.exps=e.data.exps,this.loading=!1})).catch((()=>{this.loading=!1}))},info(e){this.dialog=!0,this.dialogTitle=this.name+"详情："+e[this.idkey];var t={};t[this.idkey]=e[this.idkey],l(t).then((e=>{this.reset(e.data)})).catch((()=>{}))},cancel(){this.dialog=!1,this.reset()},submit(){this.dialog=!1,this.reset()},reset(e){this.model=e||this.$options.data().model},search(){this.query.page=1,this.list()},refresh(){const e=this.query.limit;this.query=this.$options.data().query,this.$refs.table.clearSort(),this.query.limit=e,this.list()},sort(e){this.query.sort_field=e.prop,this.query.sort_value="","ascending"===e.order&&(this.query.sort_value="asc",this.list()),"descending"===e.order&&(this.query.sort_value="desc",this.list())},select(e){this.selection=e,this.selectIds=this.selectGetIds(e).toString()},selectGetIds(e){return O(e,this.idkey)},selectAlert(){t.alert("请选择需要操作的"+this.name,"提示",{type:"warning",callback:()=>{}})},selectOpen(e,l=""){if(l){this.$refs.table.clearSelection();const e=l.length;for(let t=0;t<e;t++)this.$refs.table.toggleRowSelection(l[t],!0)}this.selection.length?(this.selectTitle="操作","dele"===e&&(this.selectTitle=this.name+"删除"),this.selectDialog=!0,this.selectType=e):this.selectAlert()},selectCancel(){this.selectDialog=!1},selectSubmit(){if(this.selection.length){"dele"===this.selectType&&this.dele(this.selection),this.selectDialog=!1}else this.selectAlert()},dele(e){e.length?(this.loading=!0,a({ids:this.selectGetIds(e)}).then((e=>{this.list(),o.success(e.msg)})).catch((()=>{this.loading=!1}))):this.selectAlert()},copy(e){$(e)},requestParamCopy(){const e=this.$refs.requestParamRef;this.copy(e.textContent)}}},[["render",function(e,l,t,a,o,A){const $=y,O=U,R=x,Y=V,H=E,M=T,F=S,L=P,Q=I,B=D,J=C,K=v,N=j,W=w,X=k,Z=q,ee=b;return s(),i(m,null,[d("div",z,[r(L,null,{default:u((()=>[r(F,null,{default:u((()=>[r($,{title:"删除选择",class:"ya-margin-right",onClick:l[0]||(l[0]=e=>A.selectOpen("dele"))},{default:u((()=>[n(" 删除 ")])),_:1}),r(R,{modelValue:o.query.search_field,"onUpdate:modelValue":l[1]||(l[1]=e=>o.query.search_field=e),class:"ya-search-field",placeholder:"查询字段"},{default:u((()=>[r(O,{value:o.idkey,label:"ID"},null,8,["value"]),r(O,{value:"request_ip",label:"请求IP"}),r(O,{value:"request_region",label:"请求地区"}),r(O,{value:"request_isp",label:"请求ISP"}),r(O,{value:"log_type",label:"日志类型"})])),_:1},8,["modelValue"]),r(R,{modelValue:o.query.search_exp,"onUpdate:modelValue":l[2]||(l[2]=e=>o.query.search_exp=e),class:"ya-search-exp"},{default:u((()=>[(s(!0),i(m,null,p(o.exps,(e=>(s(),c(O,{key:e.exp,value:e.exp,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),"log_type"==o.query.search_field?(s(),c(R,{key:0,modelValue:o.query.search_value,"onUpdate:modelValue":l[3]||(l[3]=e=>o.query.search_value=e),class:"ya-search-value",placeholder:"日志类型",clearable:""},{default:u((()=>[(s(!0),i(m,null,p(o.logTypes,((e,l)=>(s(),c(O,{key:l,value:l,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])):(s(),c(Y,{key:1,modelValue:o.query.search_value,"onUpdate:modelValue":l[4]||(l[4]=e=>o.query.search_value=e),class:"ya-search-value",placeholder:"查询内容",clearable:""},null,8,["modelValue"])),r(H,{modelValue:o.query.date_value,"onUpdate:modelValue":l[5]||(l[5]=e=>o.query.date_value=e),type:"datetimerange",class:"ya-date-value","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD HH:mm:ss","default-time":[new Date(2024,1,1,0,0,0),new Date(2024,1,1,23,59,59)]},null,8,["modelValue","default-time"]),r($,{type:"primary",onClick:l[6]||(l[6]=e=>A.search())},{default:u((()=>[n("查询")])),_:1}),r($,{title:"重置",onClick:l[7]||(l[7]=e=>A.refresh())},{default:u((()=>[r(M,{"icon-class":"refresh"})])),_:1})])),_:1})])),_:1}),r(J,{modelValue:o.selectDialog,"onUpdate:modelValue":l[9]||(l[9]=e=>o.selectDialog=e),title:o.selectTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"20vh"},{footer:u((()=>[r($,{loading:o.loading,onClick:A.selectCancel},{default:u((()=>[n("取消")])),_:1},8,["loading","onClick"]),r($,{loading:o.loading,type:"primary",onClick:A.selectSubmit},{default:u((()=>[n("提交")])),_:1},8,["loading","onClick"])])),default:u((()=>[r(B,{ref:"selectRef","label-width":"120px"},{default:u((()=>[r(Q,{label:o.name+"ID"},{default:u((()=>[r(Y,{modelValue:o.selectIds,"onUpdate:modelValue":l[8]||(l[8]=e=>o.selectIds=e),type:"textarea",autosize:"",disabled:""},null,8,["modelValue"])])),_:1},8,["label"]),"dele"===o.selectType?(s(),c(Q,{key:0},{default:u((()=>[d("span",G,"确定要删除选中的"+h(o.name)+"吗？",1)])),_:1})):_("",!0)])),_:1},512)])),_:1},8,["modelValue","title"])]),f((s(),c(W,{ref:"table",data:o.data,height:o.height,onSortChange:A.sort,onSelectionChange:A.select},{default:u((()=>[r(K,{type:"selection",width:"42",title:"全选/反选"}),r(K,{prop:o.idkey,label:"ID",width:"80",sortable:"custom"},null,8,["prop"]),r(K,{prop:"menu_id",label:"菜单ID","min-width":"100"}),r(K,{prop:"menu_name",label:"菜单名称","min-width":"150","show-overflow-tooltip":""}),r(K,{prop:"menu_url",label:"菜单链接","min-width":"250","show-overflow-tooltip":""}),r(K,{prop:"request_ip",label:"请求IP","min-width":"130"}),r(K,{prop:"request_region",label:"请求地区","min-width":"160","show-overflow-tooltip":""}),r(K,{prop:"request_isp",label:"请求ISP","min-width":"110","show-overflow-tooltip":""}),r(K,{prop:"response_code",label:"返回码","min-width":"80","show-overflow-tooltip":""}),r(K,{prop:"response_msg",label:"返回描述","min-width":"115","show-overflow-tooltip":""}),r(K,{prop:"create_time",label:"请求时间","min-width":"165",sortable:"custom"}),r(K,{label:"操作",width:"95"},{default:u((e=>[r(N,{type:"primary",class:"mr-1",underline:!1,onClick:l=>A.info(e.row)},{default:u((()=>[n(" 详情 ")])),_:2},1032,["onClick"]),r(N,{type:"primary",underline:!1,onClick:l=>A.selectOpen("dele",[e.row])},{default:u((()=>[n(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","height","onSortChange","onSelectionChange"])),[[ee,o.loading]]),f(r(X,{total:o.count,"onUpdate:total":l[10]||(l[10]=e=>o.count=e),page:o.query.page,"onUpdate:page":l[11]||(l[11]=e=>o.query.page=e),limit:o.query.limit,"onUpdate:limit":l[12]||(l[12]=e=>o.query.limit=e),onPagination:A.list},null,8,["total","page","limit","onPagination"]),[[g,o.count>0]]),r(J,{modelValue:o.dialog,"onUpdate:modelValue":l[28]||(l[28]=e=>o.dialog=e),title:o.dialogTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":A.cancel,top:"5vh"},{footer:u((()=>[r($,{loading:o.loading,onClick:A.cancel},{default:u((()=>[n("取消")])),_:1},8,["loading","onClick"]),r($,{loading:o.loading,type:"primary",onClick:A.submit},{default:u((()=>[n("确定")])),_:1},8,["loading","onClick"])])),default:u((()=>[r(Z,{native:"",height:o.height},{default:u((()=>[r(B,{ref:"ref",rules:o.rules,model:o.model,"label-width":"110px"},{default:u((()=>[r(Q,{label:"用户ID",prop:"user_id"},{default:u((()=>[r(Y,{modelValue:o.model.user_id,"onUpdate:modelValue":l[13]||(l[13]=e=>o.model.user_id=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"用户昵称",prop:"nickname"},{default:u((()=>[r(Y,{modelValue:o.model.nickname,"onUpdate:modelValue":l[14]||(l[14]=e=>o.model.nickname=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"用户账号",prop:"username"},{default:u((()=>[r(Y,{modelValue:o.model.username,"onUpdate:modelValue":l[15]||(l[15]=e=>o.model.username=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"菜单ID",prop:"menu_id"},{default:u((()=>[r(Y,{modelValue:o.model.menu_id,"onUpdate:modelValue":l[16]||(l[16]=e=>o.model.menu_id=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"菜单名称",prop:"menu_name"},{default:u((()=>[r(Y,{modelValue:o.model.menu_name,"onUpdate:modelValue":l[17]||(l[17]=e=>o.model.menu_name=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"菜单链接",prop:"menu_url"},{default:u((()=>[r(Y,{modelValue:o.model.menu_url,"onUpdate:modelValue":l[18]||(l[18]=e=>o.model.menu_url=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"请求方式",prop:"request_method"},{default:u((()=>[r(Y,{modelValue:o.model.request_method,"onUpdate:modelValue":l[19]||(l[19]=e=>o.model.request_method=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"请求IP",prop:"request_ip"},{default:u((()=>[r(Y,{modelValue:o.model.request_ip,"onUpdate:modelValue":l[20]||(l[20]=e=>o.model.request_ip=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"请求地区",prop:"request_region"},{default:u((()=>[r(Y,{modelValue:o.model.request_region,"onUpdate:modelValue":l[21]||(l[21]=e=>o.model.request_region=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"请求ISP",prop:"request_isp"},{default:u((()=>[r(Y,{modelValue:o.model.request_isp,"onUpdate:modelValue":l[22]||(l[22]=e=>o.model.request_isp=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"请求时间",prop:"create_time"},{default:u((()=>[r(Y,{modelValue:o.model.create_time,"onUpdate:modelValue":l[23]||(l[23]=e=>o.model.create_time=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"返回码",prop:"response_code"},{default:u((()=>[r(Y,{modelValue:o.model.response_code,"onUpdate:modelValue":l[24]||(l[24]=e=>o.model.response_code=e)},null,8,["modelValue"])])),_:1}),r(Q,{label:"返回描述",prop:"response_msg"},{default:u((()=>[r(Y,{modelValue:o.model.response_msg,"onUpdate:modelValue":l[25]||(l[25]=e=>o.model.response_msg=e),type:"textarea"},null,8,["modelValue"])])),_:1}),r(Q,{label:"用户代理",prop:"user_agent"},{default:u((()=>[r(Y,{modelValue:o.model.user_agent,"onUpdate:modelValue":l[26]||(l[26]=e=>o.model.user_agent=e),type:"textarea",autosize:""},null,8,["modelValue"])])),_:1}),r(Q,{label:"请求参数",prop:"request_param"},{default:u((()=>[r(F,{span:24},{default:u((()=>[r($,{text:"",type:"primary",title:"复制参数",onClick:l[27]||(l[27]=e=>A.requestParamCopy())},{default:u((()=>[r(M,{"icon-class":"copy-document"})])),_:1})])),_:1}),d("pre",{ref:"requestParamRef"},h(o.model.request_param),513)])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["height"])])),_:1},8,["modelValue","title","before-close"])],64)}]]);export{H as default};
